{"version":3,"file":"js/631.d712c00c.js","mappings":"mKAAA,IAAIA,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACA,EAAG,SAAS,CAACE,IAAI,SAASC,MAAM,CAAC,cAAcL,EAAIM,QAAQC,GAAG,CAAC,oBAAoB,SAASC,GAAQR,EAAIM,OAAOE,CAAM,EAAE,qBAAqB,SAASA,GAAQR,EAAIM,OAAOE,CAAM,KAAKN,EAAG,SAAS,CAACK,GAAG,CAAC,MAAQP,EAAIS,SAAS,CAACT,EAAIU,GAAG,aAAa,EAC3T,EACIC,EAAkB,GCFlBZ,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACG,MAAM,CAAC,GAAK,WAAW,CAACH,EAAG,UAAU,CAACE,IAAI,YAAYC,MAAM,CAAC,OAAS,CAAEO,MAAO,IAAKC,OAAQ,MAAON,GAAG,CAAC,UAAYP,EAAIc,uBAAuB,CAACZ,EAAG,UAAU,CAACA,EAAG,UAAU,CAACE,IAAI,cAAcJ,EAAIe,GAAIC,OAAOC,OAAOjB,EAAIM,SAAS,SAASY,GAAO,OAAOhB,EAAG,UAAU,CAACiB,IAAID,EAAME,GAAGf,MAAM,CAAC,OAASa,IAAQ,IAAG,GAAGhB,EAAG,gBAAgB,CAACE,IAAI,iBAAiB,IAAI,IAAI,EAC9a,EACIO,EAAkB,GCWtB,GACAU,MAAAA,CACAC,WAAAA,OAEAC,OACA,OACAjB,OAAAA,CAAAA,EACAkB,aAAAA,KACAC,WAAAA,KACAC,YAAAA,KACAC,UAAAA,KAEA,EACAC,MAAAA,CACAN,aACA,qBACA,GAEAO,UACA,mDACA,iDACA,+CACA,qBACA,EACAC,QAAAA,CACAhB,qBAAAA,GACA,kCAIA,OAHA,0BACA,4BACA,yBAIA,QACAiB,gBAAAA,EAAAA,OAAAA,YAAAA,UACA,KACA,OAGA,wBACA,mDACA,IACA,yBACA,uCACA,oCACA,GAEA,+BAEA,wBACA,EACAC,oBAEA,yBACA,iBACAC,EAAAA,aACA,iCAEA,OACA,mBAEA,8BACAA,EAAAA,SAAAA,KAAAA,eAGAA,EAAAA,QACA,CACAA,EAAAA,WAAAA,WACA,EACAC,iBACA,6BACA,oBACA,gBACAC,EAAAA,IAAAA,EACAA,EAAAA,OAAAA,KACA,yBACAf,GAAAA,EACAF,MAAAA,EACAkB,WAAAA,EACAC,KAAAA,EACAC,EAAAA,EACAC,EAAAA,GACA,CAEA,IAEA,EACAC,sBACA,8BACAC,GAAAA,IAAAA,KAAAA,oBAEA,mCAEA,iDACA,uBACA,wBAGA,IC/GoQ,I,UCOhQC,GAAY,OACd,EACA,EACA,GACA,EACA,KACA,KACA,MAIF,EAAeA,EAAiB,QCVhC,kBACA,mBAGA,OACAC,WAAAA,CACAC,OAAAA,GAEArB,OACA,OACAjB,OAAAA,CACA,wCACA,wCACA,yCAGA,EACAwB,QAAAA,CACArB,SACA,uCACA,IC5BwQ,ICOpQ,GAAY,OACd,EACAV,EACAY,GACA,EACA,KACA,KACA,MAIF,EAAe,EAAiB,O","sources":["webpack://hello-world/./src/views/Konva/KonvaEditorTest.vue","webpack://hello-world/./src/views/Konva/KonvaEditor.vue","webpack://hello-world/src/views/Konva/KonvaEditor.vue","webpack://hello-world/./src/views/Konva/KonvaEditor.vue?1041","webpack://hello-world/./src/views/Konva/KonvaEditor.vue?ec72","webpack://hello-world/src/views/Konva/KonvaEditorTest.vue","webpack://hello-world/./src/views/Konva/KonvaEditorTest.vue?18a8","webpack://hello-world/./src/views/Konva/KonvaEditorTest.vue?4e5c"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('editor',{ref:\"editor\",attrs:{\"image-props\":_vm.images},on:{\"update:imageProps\":function($event){_vm.images=$event},\"update:image-props\":function($event){_vm.images=$event}}}),_c('button',{on:{\"click\":_vm.remove}},[_vm._v(\"remove\")])],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{attrs:{\"id\":\"editor\"}},[_c('v-stage',{ref:\"stageArea\",attrs:{\"config\":{ width: 600, height: 600 }},on:{\"mousedown\":_vm.handleStageMouseDown}},[_c('v-layer',[_c('v-group',{ref:\"imageGroup\"},_vm._l((Object.values(_vm.images)),function(image){return _c('v-image',{key:image.id,attrs:{\"config\":image}})}),1),_c('v-transformer',{ref:\"transformer\"})],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div id=\"editor\">\r\n        <v-stage ref=\"stageArea\" :config=\"{ width: 600, height: 600 }\" @mousedown=\"handleStageMouseDown\">\r\n            <v-layer>\r\n                <v-group ref=\"imageGroup\">\r\n                    <v-image v-for=\"image in Object.values(images)\" :key=\"image.id\" :config=\"image\" />\r\n                </v-group>\r\n                <v-transformer ref=\"transformer\" />\r\n            </v-layer>\r\n        </v-stage>\r\n    </div>\r\n</template>\r\n<script>\r\nexport default {\r\n    props: {\r\n        imageProps: Array\r\n    },\r\n    data() {\r\n        return {\r\n            images: {},\r\n            selectedNode: null,\r\n            imageGroup: null,\r\n            transformer: null,\r\n            stageArea: null\r\n        };\r\n    },\r\n    watch: {\r\n        imageProps() {\r\n            this.registerImages();\r\n        }\r\n    },\r\n    mounted() {\r\n        this.transformer = this.$refs.transformer.getStage();\r\n        this.imageGroup = this.$refs.imageGroup.getStage();\r\n        this.stageArea = this.$refs.stageArea.getStage();\r\n        this.registerImages();\r\n    },\r\n    methods: {\r\n        handleStageMouseDown(e) {\r\n            if (e.target === e.target.getStage()) {\r\n                this.selectedImageName = \"\";\r\n                this.selectedNode = null;\r\n                this.updateTransformer();\r\n                return;\r\n            }\r\n            // clicked on transformer - do nothing\r\n            const clickedOnTransformer =\r\n                e.target.getParent().className === \"Transformer\";\r\n            if (clickedOnTransformer) {\r\n                return;\r\n            }\r\n            // find clicked rect by its name\r\n            const name = e.target.name();\r\n            const rect = Object.values(this.images).find(r => r.name === name);\r\n            if (rect) {\r\n                this.selectedImageName = name;\r\n                this.selectedNode = this.imageGroup.find(\r\n                    \".\".concat(this.selectedImageName)\r\n                )[0];\r\n\r\n                this.selectedNode.moveToTop();\r\n            }\r\n            this.updateTransformer();\r\n        },\r\n        updateTransformer() {\r\n            // here we need to manually attach or detach Transformer node\r\n            const transformerNode = this.transformer;\r\n            if (this.cropMode) {\r\n                transformerNode.detach();\r\n            } else if (this.selectedNode === transformerNode.node()) {\r\n                // do nothing if selected node is already attached\r\n                return;\r\n            } else if (this.selectedNode) {\r\n                // attach to another node\r\n                this.selectedNode.moveToTop();\r\n                transformerNode.attachTo(this.selectedNode);\r\n            } else {\r\n                // remove transformer\r\n                transformerNode.detach();\r\n            }\r\n            transformerNode.getLayer().batchDraw();\r\n        },\r\n        registerImages() {\r\n            this.imageProps.forEach(url => {\r\n                if (!this.images[url]) {\r\n                    let img = new Image();\r\n                    img.src = url;\r\n                    img.onload = () => {\r\n                        this.$set(this.images, url, {\r\n                            id: url,\r\n                            image: img,\r\n                            draggable: true,\r\n                            name: url,\r\n                            x: 0,\r\n                            y: 0\r\n                        });\r\n                    };\r\n                }\r\n            });\r\n        },\r\n        removeSelectedImage() {\r\n            let newImageProps = this.imageProps.filter(\r\n                url => url !== this.selectedImageName\r\n            );\r\n            this.$emit(\"update:image-props\", newImageProps);\r\n\r\n            this.$delete(this.images, this.selectedImageName);\r\n            this.selectedNode = null;\r\n            this.updateTransformer();\r\n\r\n            // this.stageArea.draw();\r\n        }\r\n    }\r\n};\r\n</script>\r\n  ","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./KonvaEditor.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./KonvaEditor.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./KonvaEditor.vue?vue&type=template&id=d6a19566&\"\nimport script from \"./KonvaEditor.vue?vue&type=script&lang=js&\"\nexport * from \"./KonvaEditor.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\r\n    <div>\r\n      <editor ref=\"editor\" :image-props.sync=\"images\"/>\r\n      <button @click=\"remove\">remove</button>\r\n    </div>\r\n  </template>\r\n  \r\n  <script>\r\n  const width = window.innerWidth;\r\n  const height = window.innerHeight;\r\n  import Editor from \"@/views/Konva/KonvaEditor.vue\"; //\"./Editor.vue\";\r\n  \r\n  export default {\r\n    components: {\r\n      Editor\r\n    },\r\n    data() {\r\n      return {\r\n        images: [\r\n          \"https://picsum.photos/200/300?image=0\",\r\n          \"https://picsum.photos/200/300?image=1\",\r\n          \"https://picsum.photos/200/300?image=3\"\r\n        ]\r\n      };\r\n    },\r\n    methods: {\r\n      remove() {\r\n        this.$refs.editor.removeSelectedImage();\r\n      }\r\n    }\r\n  };\r\n  </script>\r\n  ","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./KonvaEditorTest.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./KonvaEditorTest.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./KonvaEditorTest.vue?vue&type=template&id=2a175802&\"\nimport script from \"./KonvaEditorTest.vue?vue&type=script&lang=js&\"\nexport * from \"./KonvaEditorTest.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","ref","attrs","images","on","$event","remove","_v","staticRenderFns","width","height","handleStageMouseDown","_l","Object","values","image","key","id","props","imageProps","data","selectedNode","imageGroup","transformer","stageArea","watch","mounted","methods","e","updateTransformer","transformerNode","registerImages","img","draggable","name","x","y","removeSelectedImage","url","component","components","Editor"],"sourceRoot":""}